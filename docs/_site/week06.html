<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A comprehensive educational resource for learning Artificial Intelligence - structured 14-week curriculum for undergraduate students">
  
  <title>Week 6: Reasoning under Uncertainty | AI Learning Students</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Custom styles -->
  <link rel="stylesheet" href="/ai-learning-students/assets/css/style.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Navigation Header -->
    <header class="site-header">
      <nav class="nav-container">
        <div class="nav-brand">
          <a href="/ai-learning-students/" class="brand-link">
            <div class="brand-icon">
              <i class="fas fa-brain"></i>
            </div>
            <span class="brand-text">AI Learning Students</span>
          </a>
        </div>
        
        <div class="nav-menu" id="navMenu">
          <div class="nav-links">
            <a href="/ai-learning-students/" class="nav-link ">
              <i class="fas fa-home"></i>
              Home
            </a>
            <div class="nav-dropdown">
              <a href="#" class="nav-link dropdown-toggle">
                <i class="fas fa-book"></i>
                Weeks
                <i class="fas fa-chevron-down"></i>
              </a>
              <div class="dropdown-menu">
                
                  
                  <a href="/ai-learning-students/week01.html" class="dropdown-link">
                    Week 1
                  </a>
                
                  
                  <a href="/ai-learning-students/week02.html" class="dropdown-link">
                    Week 2
                  </a>
                
                  
                  <a href="/ai-learning-students/week03.html" class="dropdown-link">
                    Week 3
                  </a>
                
                  
                  <a href="/ai-learning-students/week04.html" class="dropdown-link">
                    Week 4
                  </a>
                
                  
                  <a href="/ai-learning-students/week05.html" class="dropdown-link">
                    Week 5
                  </a>
                
                  
                  <a href="/ai-learning-students/week06.html" class="dropdown-link">
                    Week 6
                  </a>
                
                  
                  <a href="/ai-learning-students/week07.html" class="dropdown-link">
                    Week 7
                  </a>
                
                  
                  <a href="/ai-learning-students/week08.html" class="dropdown-link">
                    Week 8
                  </a>
                
                  
                  <a href="/ai-learning-students/week09.html" class="dropdown-link">
                    Week 9
                  </a>
                
                  
                  <a href="/ai-learning-students/week10.html" class="dropdown-link">
                    Week 10
                  </a>
                
                  
                  <a href="/ai-learning-students/week11.html" class="dropdown-link">
                    Week 11
                  </a>
                
                  
                  <a href="/ai-learning-students/week12.html" class="dropdown-link">
                    Week 12
                  </a>
                
                  
                  <a href="/ai-learning-students/week13.html" class="dropdown-link">
                    Week 13
                  </a>
                
                  
                  <a href="/ai-learning-students/week14.html" class="dropdown-link">
                    Week 14
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="nav-progress">
            <div class="progress-indicator">
              <div class="progress-circle">
                <div class="progress-fill"></div>
                <span class="progress-text">0%</span>
              </div>
            </div>
          </div>
        </div>
        
        <button class="mobile-menu-toggle" id="mobileToggle">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <div class="content-container">
        <div class="week-header">
  <div class="week-hero">
    <div class="week-number-large"></div>
    <div class="week-title-section">
      <h1>Week 6: Reasoning under Uncertainty</h1>
      <div class="week-progress-bar">
        <div class="progress-fill" style="width: 0.0%"></div>
      </div>
    </div>
  </div>
  
  <div class="week-navigation">
    
    
    
    <a href="index.html" class="nav-button home">
      <i class="fas fa-home"></i>
      Course Overview
    </a>
    
    
      <a href="week01.html" class="nav-button next">
        Next Week
        <i class="fas fa-chevron-right"></i>
      </a>
    
  </div>
</div>

<div class="week-content">
  <h3 id="navigation">Navigation</h3>
<p><a href="index.html">üè† Home</a> | <a href="week05.html">‚Üê Previous: Week 5</a> | <a href="week07.html">Next: Week 7 ‚Üí</a></p>

<hr />

<h1 id="week-6-reasoning-under-uncertainty">Week 6: Reasoning under Uncertainty</h1>

<h2 id="-learning-objectives">üìö Learning Objectives</h2>
<p>By the end of this week, students will be able to:</p>
<ul>
  <li>Understand probability theory fundamentals for AI</li>
  <li>Apply Bayes‚Äô rule for probabilistic inference</li>
  <li>Work with Bayesian networks for complex reasoning</li>
  <li>Handle uncertainty in AI decision-making</li>
  <li>Implement basic probabilistic reasoning algorithms</li>
</ul>

<hr />

<h2 id="-why-uncertainty-matters-in-ai">üé≤ Why Uncertainty Matters in AI</h2>

<p>Real-world AI systems must deal with:</p>
<ul>
  <li><strong>Incomplete information</strong> - Missing data or observations</li>
  <li><strong>Noisy sensors</strong> - Measurement errors and uncertainty</li>
  <li><strong>Stochastic processes</strong> - Inherently random phenomena</li>
  <li><strong>Complex dependencies</strong> - Uncertain relationships between variables</li>
</ul>

<p><img src="images/uncertainty-in-ai.png" alt="Uncertainty in AI" /></p>

<h3 id="examples-of-uncertainty">Examples of Uncertainty</h3>
<ul>
  <li><strong>Medical diagnosis:</strong> Symptoms don‚Äôt always indicate specific diseases</li>
  <li><strong>Speech recognition:</strong> Audio signals are noisy and ambiguous</li>
  <li><strong>Computer vision:</strong> Lighting and occlusion create ambiguity</li>
  <li><strong>Natural language:</strong> Words and sentences can have multiple meanings</li>
</ul>

<hr />

<h2 id="-probability-theory-foundations">üìä Probability Theory Foundations</h2>

<h3 id="basic-probability-concepts">Basic Probability Concepts</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="k">class</span> <span class="nc">ProbabilityBasics</span><span class="p">:</span>
    <span class="s">"""Demonstrate basic probability concepts"""</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">coin_flip_simulation</span><span class="p">(</span><span class="n">n_flips</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="s">"""Simulate coin flips to demonstrate probability"""</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">([</span><span class="s">'H'</span><span class="p">,</span> <span class="s">'T'</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_flips</span><span class="p">)]</span>
        <span class="n">prob_heads</span> <span class="o">=</span> <span class="n">results</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">'H'</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_flips</span>
        <span class="k">return</span> <span class="n">prob_heads</span><span class="p">,</span> <span class="n">results</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">conditional_probability_example</span><span class="p">():</span>
        <span class="s">"""Demonstrate conditional probability with card drawing"""</span>
        <span class="c1"># P(King | Face Card) = P(King and Face Card) / P(Face Card)
</span>        <span class="c1"># Face cards: J, Q, K (12 total), Kings: 4 total
</span>        <span class="k">return</span> <span class="mi">4</span><span class="o">/</span><span class="mi">12</span>  <span class="c1"># 1/3
</span>    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">bayes_rule</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="n">evidence</span><span class="p">):</span>
        <span class="s">"""Apply Bayes' rule: P(H|E) = P(E|H) * P(H) / P(E)"""</span>
        <span class="n">posterior</span> <span class="o">=</span> <span class="p">(</span><span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span><span class="p">)</span> <span class="o">/</span> <span class="n">evidence</span>
        <span class="k">return</span> <span class="n">posterior</span>

<span class="c1"># Example usage
</span><span class="n">prob_calc</span> <span class="o">=</span> <span class="n">ProbabilityBasics</span><span class="p">()</span>
<span class="n">heads_prob</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">prob_calc</span><span class="p">.</span><span class="n">coin_flip_simulation</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Empirical probability of heads: </span><span class="si">{</span><span class="n">heads_prob</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="joint-and-conditional-probability">Joint and Conditional Probability</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProbabilityDistributions</span><span class="p">:</span>
    <span class="s">"""Work with probability distributions"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Weather example: P(Weather, Temperature)
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">joint_prob</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'hot'</span><span class="p">):</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="p">(</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'mild'</span><span class="p">):</span> <span class="mf">0.2</span><span class="p">,</span>
            <span class="p">(</span><span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'hot'</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="p">(</span><span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'mild'</span><span class="p">):</span> <span class="mf">0.2</span><span class="p">,</span>
            <span class="p">(</span><span class="s">'rainy'</span><span class="p">,</span> <span class="s">'hot'</span><span class="p">):</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="p">(</span><span class="s">'rainy'</span><span class="p">,</span> <span class="s">'mild'</span><span class="p">):</span> <span class="mf">0.15</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">marginal_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="s">"""Calculate P(variable = value)"""</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s">'weather'</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prob</span> <span class="k">for</span> <span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="n">temp</span><span class="p">),</span> <span class="n">prob</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">joint_prob</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> 
                      <span class="k">if</span> <span class="n">weather</span> <span class="o">==</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">variable</span> <span class="o">==</span> <span class="s">'temperature'</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prob</span> <span class="k">for</span> <span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="n">temp</span><span class="p">),</span> <span class="n">prob</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">joint_prob</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> 
                      <span class="k">if</span> <span class="n">temp</span> <span class="o">==</span> <span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">conditional_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var1</span><span class="p">,</span> <span class="n">val1</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">val2</span><span class="p">):</span>
        <span class="s">"""Calculate P(var1=val1 | var2=val2)"""</span>
        <span class="n">joint</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">joint_prob</span><span class="p">.</span><span class="n">get</span><span class="p">((</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">var1</span> <span class="o">==</span> <span class="s">'weather'</span> <span class="k">else</span> \
                <span class="bp">self</span><span class="p">.</span><span class="n">joint_prob</span><span class="p">.</span><span class="n">get</span><span class="p">((</span><span class="n">val2</span><span class="p">,</span> <span class="n">val1</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">marginal</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">marginal_probability</span><span class="p">(</span><span class="n">var2</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">joint</span> <span class="o">/</span> <span class="n">marginal</span> <span class="k">if</span> <span class="n">marginal</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="c1"># Example
</span><span class="n">weather_model</span> <span class="o">=</span> <span class="n">ProbabilityDistributions</span><span class="p">()</span>
<span class="n">prob_sunny</span> <span class="o">=</span> <span class="n">weather_model</span><span class="p">.</span><span class="n">marginal_probability</span><span class="p">(</span><span class="s">'weather'</span><span class="p">,</span> <span class="s">'sunny'</span><span class="p">)</span>
<span class="n">prob_sunny_given_hot</span> <span class="o">=</span> <span class="n">weather_model</span><span class="p">.</span><span class="n">conditional_probability</span><span class="p">(</span><span class="s">'weather'</span><span class="p">,</span> <span class="s">'sunny'</span><span class="p">,</span> <span class="s">'temperature'</span><span class="p">,</span> <span class="s">'hot'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P(sunny) = </span><span class="si">{</span><span class="n">prob_sunny</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P(sunny | hot) = </span><span class="si">{</span><span class="n">prob_sunny_given_hot</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-bayes-rule-and-inference">üßÆ Bayes‚Äô Rule and Inference</h2>

<h3 id="the-foundation-of-probabilistic-reasoning">The Foundation of Probabilistic Reasoning</h3>

<table>
  <tbody>
    <tr>
      <td>Bayes‚Äô Rule: P(H</td>
      <td>E) = P(E</td>
      <td>H) √ó P(H) / P(E)</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>**P(H</td>
          <td>E):** Posterior probability (what we want to know)</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>**P(E</td>
          <td>H):** Likelihood (how well hypothesis explains evidence)</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><strong>P(H):</strong> Prior probability (what we believed before)</li>
  <li><strong>P(E):</strong> Evidence probability (normalizing constant)</li>
</ul>

<h3 id="medical-diagnosis-example">Medical Diagnosis Example</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MedicalDiagnosis</span><span class="p">:</span>
    <span class="s">"""Bayesian inference for medical diagnosis"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Disease probabilities
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">disease_prior</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># 1% of population has disease
</span>        
        <span class="c1"># Test characteristics
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">test_sensitivity</span> <span class="o">=</span> <span class="mf">0.95</span>  <span class="c1"># P(positive | disease)
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">test_specificity</span> <span class="o">=</span> <span class="mf">0.90</span>  <span class="c1"># P(negative | no disease)
</span>    
    <span class="k">def</span> <span class="nf">diagnose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_result</span><span class="p">):</span>
        <span class="s">"""Use Bayes' rule to diagnose based on test result"""</span>
        <span class="k">if</span> <span class="n">test_result</span> <span class="o">==</span> <span class="s">'positive'</span><span class="p">:</span>
            <span class="c1"># P(disease | positive test)
</span>            <span class="n">likelihood</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">test_sensitivity</span>
            <span class="n">prior</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">disease_prior</span>
            
            <span class="c1"># P(positive test) = P(pos|disease)*P(disease) + P(pos|no disease)*P(no disease)
</span>            <span class="n">evidence</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">test_sensitivity</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">disease_prior</span> <span class="o">+</span> 
                       <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">test_specificity</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">disease_prior</span><span class="p">))</span>
            
            <span class="n">posterior</span> <span class="o">=</span> <span class="p">(</span><span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span><span class="p">)</span> <span class="o">/</span> <span class="n">evidence</span>
            <span class="k">return</span> <span class="n">posterior</span>
        
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># negative test
</span>            <span class="c1"># P(disease | negative test)
</span>            <span class="n">likelihood</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">test_sensitivity</span>  <span class="c1"># P(negative | disease)
</span>            <span class="n">prior</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">disease_prior</span>
            
            <span class="n">evidence</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">test_sensitivity</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">disease_prior</span> <span class="o">+</span> 
                       <span class="bp">self</span><span class="p">.</span><span class="n">test_specificity</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">disease_prior</span><span class="p">))</span>
            
            <span class="n">posterior</span> <span class="o">=</span> <span class="p">(</span><span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span><span class="p">)</span> <span class="o">/</span> <span class="n">evidence</span>
            <span class="k">return</span> <span class="n">posterior</span>

<span class="c1"># Example diagnosis
</span><span class="n">doctor</span> <span class="o">=</span> <span class="n">MedicalDiagnosis</span><span class="p">()</span>
<span class="n">prob_disease_given_positive</span> <span class="o">=</span> <span class="n">doctor</span><span class="p">.</span><span class="n">diagnose</span><span class="p">(</span><span class="s">'positive'</span><span class="p">)</span>
<span class="n">prob_disease_given_negative</span> <span class="o">=</span> <span class="n">doctor</span><span class="p">.</span><span class="n">diagnose</span><span class="p">(</span><span class="s">'negative'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P(disease | positive test) = </span><span class="si">{</span><span class="n">prob_disease_given_positive</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P(disease | negative test) = </span><span class="si">{</span><span class="n">prob_disease_given_negative</span><span class="p">:.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="Ô∏è-bayesian-networks">üï∏Ô∏è Bayesian Networks</h2>

<p>Bayesian networks provide a compact representation of joint probability distributions using conditional independence.</p>

<h3 id="simple-bayesian-network-implementation">Simple Bayesian Network Implementation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SimpleBayesianNetwork</span><span class="p">:</span>
    <span class="s">"""Basic Bayesian Network for the classic Alarm example"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Network structure: Burglary -&gt; Alarm &lt;- Earthquake
</span>        <span class="c1">#                              |
</span>        <span class="c1">#                         JohnCalls  MaryCalls
</span>        
        <span class="c1"># Prior probabilities
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">p_burglary</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p_earthquake</span> <span class="o">=</span> <span class="mf">0.002</span>
        
        <span class="c1"># Conditional probability tables
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">p_alarm</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">):</span> <span class="mf">0.95</span><span class="p">,</span>    <span class="c1"># P(Alarm | Burglary, Earthquake)
</span>            <span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span> <span class="mf">0.94</span><span class="p">,</span>   <span class="c1"># P(Alarm | Burglary, ¬¨Earthquake)
</span>            <span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">):</span> <span class="mf">0.29</span><span class="p">,</span>   <span class="c1"># P(Alarm | ¬¨Burglary, Earthquake)
</span>            <span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span> <span class="mf">0.001</span>  <span class="c1"># P(Alarm | ¬¨Burglary, ¬¨Earthquake)
</span>        <span class="p">}</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">p_john_calls_given_alarm</span> <span class="o">=</span> <span class="mf">0.90</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p_john_calls_given_no_alarm</span> <span class="o">=</span> <span class="mf">0.05</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">p_mary_calls_given_alarm</span> <span class="o">=</span> <span class="mf">0.70</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p_mary_calls_given_no_alarm</span> <span class="o">=</span> <span class="mf">0.01</span>
    
    <span class="k">def</span> <span class="nf">sample_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
        <span class="s">"""Generate samples from the network"""</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
            <span class="c1"># Sample from priors
</span>            <span class="n">burglary</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">p_burglary</span>
            <span class="n">earthquake</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">p_earthquake</span>
            
            <span class="c1"># Sample alarm given parents
</span>            <span class="n">alarm_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">p_alarm</span><span class="p">[(</span><span class="n">burglary</span><span class="p">,</span> <span class="n">earthquake</span><span class="p">)]</span>
            <span class="n">alarm</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">alarm_prob</span>
            
            <span class="c1"># Sample calls given alarm
</span>            <span class="n">john_calls</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">p_john_calls_given_alarm</span> <span class="k">if</span> <span class="n">alarm</span> 
                                          <span class="k">else</span> <span class="bp">self</span><span class="p">.</span><span class="n">p_john_calls_given_no_alarm</span><span class="p">)</span>
            <span class="n">mary_calls</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">p_mary_calls_given_alarm</span> <span class="k">if</span> <span class="n">alarm</span> 
                                          <span class="k">else</span> <span class="bp">self</span><span class="p">.</span><span class="n">p_mary_calls_given_no_alarm</span><span class="p">)</span>
            
            <span class="n">samples</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s">'burglary'</span><span class="p">:</span> <span class="n">burglary</span><span class="p">,</span>
                <span class="s">'earthquake'</span><span class="p">:</span> <span class="n">earthquake</span><span class="p">,</span> 
                <span class="s">'alarm'</span><span class="p">:</span> <span class="n">alarm</span><span class="p">,</span>
                <span class="s">'john_calls'</span><span class="p">:</span> <span class="n">john_calls</span><span class="p">,</span>
                <span class="s">'mary_calls'</span><span class="p">:</span> <span class="n">mary_calls</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">samples</span>
    
    <span class="k">def</span> <span class="nf">query_given_evidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">query_var</span><span class="p">,</span> <span class="n">evidence</span><span class="p">):</span>
        <span class="s">"""Estimate P(query_var | evidence) from samples"""</span>
        <span class="n">matching_samples</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="c1"># Check if sample matches evidence
</span>            <span class="n">match</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">==</span> <span class="n">val</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">evidence</span><span class="p">.</span><span class="n">items</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">matching_samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">matching_samples</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="c1"># Calculate probability of query variable
</span>        <span class="n">query_true</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">matching_samples</span> <span class="k">if</span> <span class="n">sample</span><span class="p">[</span><span class="n">query_var</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">query_true</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_samples</span><span class="p">)</span>

<span class="c1"># Example usage
</span><span class="n">bn</span> <span class="o">=</span> <span class="n">SimpleBayesianNetwork</span><span class="p">()</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">bn</span><span class="p">.</span><span class="n">sample_network</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>

<span class="c1"># Query: P(Burglary | JohnCalls=True, MaryCalls=True)
</span><span class="n">evidence</span> <span class="o">=</span> <span class="p">{</span><span class="s">'john_calls'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">'mary_calls'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="n">prob_burglary</span> <span class="o">=</span> <span class="n">bn</span><span class="p">.</span><span class="n">query_given_evidence</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s">'burglary'</span><span class="p">,</span> <span class="n">evidence</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P(Burglary | Both call) ‚âà </span><span class="si">{</span><span class="n">prob_burglary</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># Query: P(Earthquake | JohnCalls=True, MaryCalls=False)  
</span><span class="n">evidence</span> <span class="o">=</span> <span class="p">{</span><span class="s">'john_calls'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">'mary_calls'</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
<span class="n">prob_earthquake</span> <span class="o">=</span> <span class="n">bn</span><span class="p">.</span><span class="n">query_given_evidence</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s">'earthquake'</span><span class="p">,</span> <span class="n">evidence</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P(Earthquake | John calls, Mary doesn't) ‚âà </span><span class="si">{</span><span class="n">prob_earthquake</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-probabilistic-inference-algorithms">üéØ Probabilistic Inference Algorithms</h2>

<h3 id="variable-elimination">Variable Elimination</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">VariableElimination</span><span class="p">:</span>
    <span class="s">"""Simplified variable elimination for small networks"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">network</span> <span class="o">=</span> <span class="n">network</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">factors</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span> <span class="nf">eliminate_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">factors</span><span class="p">):</span>
        <span class="s">"""Eliminate a variable by summing out"""</span>
        <span class="c1"># This is a simplified version - real implementation would be more complex
</span>        <span class="n">relevant_factors</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">factors</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">f</span><span class="p">.</span><span class="n">variables</span><span class="p">]</span>
        <span class="n">other_factors</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">factors</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">.</span><span class="n">variables</span><span class="p">]</span>
        
        <span class="c1"># Join relevant factors and sum out variable
</span>        <span class="k">if</span> <span class="n">relevant_factors</span><span class="p">:</span>
            <span class="n">joined</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">join_factors</span><span class="p">(</span><span class="n">relevant_factors</span><span class="p">)</span>
            <span class="n">summed_out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">sum_out_variable</span><span class="p">(</span><span class="n">joined</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">other_factors</span> <span class="o">+</span> <span class="p">[</span><span class="n">summed_out</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">factors</span>
    
    <span class="k">def</span> <span class="nf">join_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="p">):</span>
        <span class="s">"""Join multiple factors into one"""</span>
        <span class="c1"># Implementation would multiply probability tables
</span>        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">sum_out_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
        <span class="s">"""Sum out a variable from a factor"""</span>
        <span class="c1"># Implementation would marginalize over variable
</span>        <span class="k">pass</span>
</code></pre></div></div>

<h3 id="markov-chain-monte-carlo-mcmc">Markov Chain Monte Carlo (MCMC)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MCMCSampler</span><span class="p">:</span>
    <span class="s">"""MCMC sampling for Bayesian networks"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">network</span> <span class="o">=</span> <span class="n">network</span>
    
    <span class="k">def</span> <span class="nf">gibbs_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evidence</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">burn_in</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="s">"""Gibbs sampling for posterior inference"""</span>
        <span class="c1"># Initialize all variables randomly
</span>        <span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="n">var</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span> 
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">network</span><span class="p">.</span><span class="n">variables</span><span class="p">}</span>
        
        <span class="c1"># Set evidence variables
</span>        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">evidence</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">state</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span> <span class="o">+</span> <span class="n">burn_in</span><span class="p">):</span>
            <span class="c1"># Sample each non-evidence variable given others
</span>            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">network</span><span class="p">.</span><span class="n">variables</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">evidence</span><span class="p">:</span>
                    <span class="n">state</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">sample_variable_given_others</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
            
            <span class="c1"># Collect samples after burn-in
</span>            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">burn_in</span><span class="p">:</span>
                <span class="n">samples</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">copy</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="n">samples</span>
    
    <span class="k">def</span> <span class="nf">sample_variable_given_others</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="s">"""Sample variable given current state of others"""</span>
        <span class="c1"># Calculate P(var | markov_blanket)
</span>        <span class="c1"># This would use the network structure and CPTs
</span>        <span class="n">prob_true</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">calculate_conditional_prob</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">prob_true</span>
    
    <span class="k">def</span> <span class="nf">calculate_conditional_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="s">"""Calculate P(var=value | current_state)"""</span>
        <span class="c1"># Implementation would use Markov blanket
</span>        <span class="k">return</span> <span class="mf">0.5</span>  <span class="c1"># Placeholder
</span></code></pre></div></div>

<hr />

<h2 id="-hands-on-exercise-spam-filter-with-naive-bayes">üíª Hands-On Exercise: Spam Filter with Naive Bayes</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>

<span class="k">class</span> <span class="nc">NaiveBayesSpamFilter</span><span class="p">:</span>
    <span class="s">"""Naive Bayes classifier for spam detection"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span> <span class="o">=</span> <span class="p">{</span><span class="s">'spam'</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="s">'ham'</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">class_counts</span> <span class="o">=</span> <span class="p">{</span><span class="s">'spam'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">'ham'</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emails</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="s">"""Train the classifier on labeled emails"""</span>
        <span class="k">for</span> <span class="n">email</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">emails</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">class_counts</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">email</span><span class="p">.</span><span class="n">lower</span><span class="p">().</span><span class="n">split</span><span class="p">()</span>
            
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="n">word</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">vocabulary</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">):</span>
        <span class="s">"""Classify an email as spam or ham"""</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">email</span><span class="p">.</span><span class="n">lower</span><span class="p">().</span><span class="n">split</span><span class="p">()</span>
        
        <span class="c1"># Calculate log probabilities to avoid underflow
</span>        <span class="n">log_prob_spam</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">class_counts</span><span class="p">[</span><span class="s">'spam'</span><span class="p">]</span> <span class="o">/</span> 
                                <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">class_counts</span><span class="p">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">log_prob_ham</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">class_counts</span><span class="p">[</span><span class="s">'ham'</span><span class="p">]</span> <span class="o">/</span> 
                               <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">class_counts</span><span class="p">.</span><span class="n">values</span><span class="p">()))</span>
        
        <span class="c1"># Add log-likelihood for each word
</span>        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">vocabulary</span><span class="p">:</span>
                <span class="c1"># Laplace smoothing
</span>                <span class="n">prob_word_given_spam</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'spam'</span><span class="p">][</span><span class="n">word</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> 
                                       <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'spam'</span><span class="p">].</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> 
                                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">vocabulary</span><span class="p">)))</span>
                <span class="n">prob_word_given_ham</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'ham'</span><span class="p">][</span><span class="n">word</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> 
                                      <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'ham'</span><span class="p">].</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> 
                                       <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">vocabulary</span><span class="p">)))</span>
                
                <span class="n">log_prob_spam</span> <span class="o">+=</span> <span class="n">math</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob_word_given_spam</span><span class="p">)</span>
                <span class="n">log_prob_ham</span> <span class="o">+=</span> <span class="n">math</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob_word_given_ham</span><span class="p">)</span>
        
        <span class="c1"># Return class with higher probability
</span>        <span class="k">return</span> <span class="s">'spam'</span> <span class="k">if</span> <span class="n">log_prob_spam</span> <span class="o">&gt;</span> <span class="n">log_prob_ham</span> <span class="k">else</span> <span class="s">'ham'</span>
    
    <span class="k">def</span> <span class="nf">get_word_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
        <span class="s">"""Get P(word | class) for both classes"""</span>
        <span class="n">total_spam</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'spam'</span><span class="p">].</span><span class="n">values</span><span class="p">())</span>
        <span class="n">total_ham</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'ham'</span><span class="p">].</span><span class="n">values</span><span class="p">())</span>
        <span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">vocabulary</span><span class="p">)</span>
        
        <span class="n">prob_spam</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'spam'</span><span class="p">][</span><span class="n">word</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">total_spam</span> <span class="o">+</span> <span class="n">vocab_size</span><span class="p">)</span>
        <span class="n">prob_ham</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">word_counts</span><span class="p">[</span><span class="s">'ham'</span><span class="p">][</span><span class="n">word</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">total_ham</span> <span class="o">+</span> <span class="n">vocab_size</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">prob_spam</span><span class="p">,</span> <span class="n">prob_ham</span>

<span class="c1"># Example usage
</span><span class="n">spam_filter</span> <span class="o">=</span> <span class="n">NaiveBayesSpamFilter</span><span class="p">()</span>

<span class="c1"># Training data
</span><span class="n">emails</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"buy now cheap viagra discount"</span><span class="p">,</span>
    <span class="s">"meeting tomorrow at 3pm conference room"</span><span class="p">,</span>
    <span class="s">"free money click here now"</span><span class="p">,</span>
    <span class="s">"project deadline next week please review"</span><span class="p">,</span>
    <span class="s">"congratulations you won million dollars"</span><span class="p">,</span>
    <span class="s">"lunch plans for friday anyone interested"</span>
<span class="p">]</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'spam'</span><span class="p">,</span> <span class="s">'ham'</span><span class="p">,</span> <span class="s">'spam'</span><span class="p">,</span> <span class="s">'ham'</span><span class="p">,</span> <span class="s">'spam'</span><span class="p">,</span> <span class="s">'ham'</span><span class="p">]</span>

<span class="n">spam_filter</span><span class="p">.</span><span class="n">train</span><span class="p">(</span><span class="n">emails</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1"># Test classification
</span><span class="n">test_email</span> <span class="o">=</span> <span class="s">"free discount offer click now"</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">spam_filter</span><span class="p">.</span><span class="n">classify</span><span class="p">(</span><span class="n">test_email</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Email: '</span><span class="si">{</span><span class="n">test_email</span><span class="si">}</span><span class="s">' -&gt; </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># Analyze word probabilities
</span><span class="n">word</span> <span class="o">=</span> <span class="s">"free"</span>
<span class="n">prob_spam</span><span class="p">,</span> <span class="n">prob_ham</span> <span class="o">=</span> <span class="n">spam_filter</span><span class="p">.</span><span class="n">get_word_probabilities</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P('</span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s">' | spam) = </span><span class="si">{</span><span class="n">prob_spam</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"P('</span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s">' | ham) = </span><span class="si">{</span><span class="n">prob_ham</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="-curated-resources">üîó Curated Resources</h2>

<h3 id="essential-reading">Essential Reading</h3>
<ul>
  <li><a href="https://aima.cs.berkeley.edu/">AIMA Chapter 13-14</a> - Uncertainty and Probabilistic Reasoning</li>
  <li><a href="https://greenteapress.com/wp/think-bayes/">Think Bayes</a> - Free book on Bayesian statistics</li>
</ul>

<h3 id="video-resources">Video Resources</h3>
<ul>
  <li><a href="https://www.youtube.com/watch?v=HZGCoVF3YvM">Bayes‚Äô Theorem</a> - 3Blue1Brown (15 min)</li>
  <li><a href="https://www.youtube.com/watch?v=TuGDMj43ehw">Bayesian Networks</a> - Intro to probabilistic graphical models</li>
  <li><a href="https://www.youtube.com/watch?v=O2L2Uv9pdDA">Naive Bayes</a> - Machine learning explanation</li>
</ul>

<h3 id="interactive-learning">Interactive Learning</h3>
<ul>
  <li><a href="https://seeing-theory.brown.edu/bayesian-inference/index.html">Bayes‚Äô Rule Visualization</a></li>
  <li><a href="https://aispace.org/bayes/">Probabilistic Reasoning</a> - Interactive Bayesian network tool</li>
  <li><a href="https://www.ncrg.aston.ac.uk/netlab/demos/medical/medical.html">Medical Diagnosis Simulator</a></li>
</ul>

<hr />

<h2 id="-key-concepts-summary">üéØ Key Concepts Summary</h2>

<h3 id="probability-fundamentals">Probability Fundamentals</h3>
<ul>
  <li><strong>Joint, marginal, conditional probabilities</strong></li>
  <li><strong>Bayes‚Äô rule for updating beliefs</strong></li>
  <li><strong>Independence and conditional independence</strong></li>
</ul>

<h3 id="bayesian-networks">Bayesian Networks</h3>
<ul>
  <li><strong>Compact representation of joint distributions</strong></li>
  <li><strong>Exploit conditional independence</strong></li>
  <li><strong>Enable efficient probabilistic inference</strong></li>
</ul>

<h3 id="practical-applications">Practical Applications</h3>
<ul>
  <li><strong>Medical diagnosis systems</strong></li>
  <li><strong>Spam filtering and text classification</strong></li>
  <li><strong>Sensor fusion and robotics</strong></li>
  <li><strong>Decision support systems</strong></li>
</ul>

<hr />

<h2 id="-discussion-questions">ü§î Discussion Questions</h2>

<ol>
  <li>How does probabilistic reasoning differ from logical reasoning?</li>
  <li>When might you prefer frequentist vs. Bayesian approaches?</li>
  <li>What are the assumptions of Naive Bayes and when do they break down?</li>
  <li>How do you handle missing data in probabilistic models?</li>
</ol>

<hr />

<h2 id="-looking-ahead">üîç Looking Ahead</h2>

<p>Next week, we‚Äôll dive into <strong>machine learning fundamentals</strong> - the foundation for building systems that can learn patterns from data and make predictions about new, unseen examples.</p>

<hr />

<h3 id="navigation-1">Navigation</h3>
<p><a href="index.html">üè† Home</a> | <a href="week05.html">‚Üê Previous: Week 5</a> | <a href="week07.html">Next: Week 7 ‚Üí</a></p>

<hr />

<p><em>‚ÄúProbability is not about the odds of something happening, but about what we know of those odds.‚Äù</em> - Nate Silver</p>

</div>

<style>
.week-header {
  margin: -2rem -1.5rem 3rem -1.5rem;
  padding: 2rem 1.5rem;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(139, 92, 246, 0.08) 100%);
  border-radius: 0 0 1.5rem 1.5rem;
}

.week-hero {
  display: flex;
  align-items: center;
  gap: 2rem;
  max-width: var(--container-max-width);
  margin: 0 auto;
}

.week-number-large {
  font-size: 4rem;
  font-weight: 800;
  background: var(--primary-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  opacity: 0.8;
  min-width: 5rem;
  text-align: center;
}

.week-title-section {
  flex: 1;
}

.week-title-section h1 {
  margin-bottom: 1rem;
  font-size: 2rem;
}

.week-progress-bar {
  width: 100%;
  height: 8px;
  background: rgba(255, 255, 255, 0.3);
  border-radius: 4px;
  overflow: hidden;
}

.week-progress-bar .progress-fill {
  height: 100%;
  background: var(--primary-gradient);
  border-radius: 4px;
  transition: width 0.8s ease;
}

.week-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 2rem;
  max-width: var(--container-max-width);
  margin-left: auto;
  margin-right: auto;
}

.week-content {
  animation: fadeInUp 0.6s ease-out;
}

.learning-objectives {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(139, 92, 246, 0.05));
  border: 1px solid rgba(99, 102, 241, 0.1);
  border-left: 4px solid var(--primary-color);
  padding: 2rem;
  border-radius: var(--border-radius);
  margin: 2rem 0;
  box-shadow: var(--shadow);
}

.learning-objectives h2 {
  color: var(--primary-color);
  margin-bottom: 1.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.learning-objectives ul {
  list-style: none;
  padding: 0;
}

.learning-objectives li {
  position: relative;
  padding-left: 2rem;
  margin-bottom: 1rem;
  color: var(--text-secondary);
}

.learning-objectives li::before {
  content: '‚úì';
  position: absolute;
  left: 0;
  color: var(--accent-3);
  font-weight: bold;
  font-size: 1.2rem;
}

@media (max-width: 768px) {
  .week-header {
    margin: -2rem -1rem 2rem -1rem;
    padding: 1.5rem 1rem;
  }
  
  .week-hero {
    flex-direction: column;
    text-align: center;
    gap: 1rem;
  }
  
  .week-number-large {
    font-size: 3rem;
  }
  
  .week-title-section h1 {
    font-size: 1.5rem;
  }
  
  .week-navigation {
    flex-direction: column;
    gap: 1rem;
  }
}
</style>
      </div>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
      <div class="footer-container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>AI Learning Students</h3>
            <p>A comprehensive educational resource for learning Artificial Intelligence - structured 14-week curriculum for undergraduate students</p>
          </div>
          <div class="footer-section">
            <h4>Quick Links</h4>
            <ul>
              <li><a href="/ai-learning-students/">Course Overview</a></li>
              <li><a href="https://github.com/irfan-sec/ai-learning-students">GitHub Repository</a></li>
              <li><a href="/ai-learning-students/week01.html">Get Started</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h4>Resources</h4>
            <ul>
              <li><a href="https://aima.cs.berkeley.edu/">AIMA Textbook</a></li>
              <li><a href="https://scikit-learn.org/">Scikit-learn</a></li>
              <li><a href="https://www.fast.ai/">Fast.ai</a></li>
            </ul>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2024 AI Learning Community. Licensed under MIT License.</p>
        </div>
      </div>
    </footer>
  </div>

  <!-- Scripts -->
  <script src="/ai-learning-students/assets/js/theme.js"></script>
</body>
</html>